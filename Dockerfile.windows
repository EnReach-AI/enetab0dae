# 用于编译 Windows 版本的 Go 动态库
FROM golang:1.25-alpine

RUN apk add --no-cache mingw-w64-gcc

WORKDIR /build
COPY core /build

RUN CC=x86_64-w64-mingw32-gcc CGO_ENABLED=1 GOOS=windows GOARCH=amd64 go build \
    -buildmode=c-shared -o /build/libstudy.dll ./pkg/libstudy && \
    cp /build/pkg/libstudy/libstudy.h /build/

CMD ["echo", "Windows build complete"]
